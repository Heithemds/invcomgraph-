<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Inventaire Atelier</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="bg"></div>

  <header class="topbar">
    <div class="brand">
      <div class="logo">⚡</div>
      <div>
        <div class="title">Inventaire Atelier</div>
        <div class="subtitle">Scan étiquette • Base centralisée • Totaux</div>
      </div>
    </div>
    <div class="session" id="sessionBox">
      <span class="pill" id="sessionPill">Hors connexion</span>
      <button class="btn ghost" id="btnLogout" disabled>Déconnexion</button>
    </div>
  </header>

  <main class="wrap">
    <!-- AUTH -->
    <section class="card" id="authCard">
      <h1>Accès</h1>
      <p class="muted">
        5 personnes, simple et rapide : nom + PIN (6 chiffres).
      </p>

      <div class="grid2">
        <div class="field">
          <label>Nom</label>
          <input id="authName" placeholder="Ex : Mouna" autocomplete="name" />
        </div>
        <div class="field">
          <label>PIN (6 chiffres)</label>
          <input id="authPin" placeholder="******" inputmode="numeric" maxlength="6" />
        </div>
      </div>

      <div class="field" id="confirmWrap" style="display:none;">
        <label>Confirmer PIN (6 chiffres)</label>
        <input id="authPin2" placeholder="******" inputmode="numeric" maxlength="6" />
      </div>

      <div class="actions">
        <button class="btn" id="btnRegister">S’inscrire</button>
        <button class="btn primary" id="btnLogin">Se connecter</button>
      </div>

      <details class="diag">
        <summary>Diagnostics rapides</summary>
        <div class="muted small" id="diagBox">—</div>
      </details>
    </section>

    <!-- SAISIE -->
    <section class="card" id="entryCard" style="display:none;">
      <div class="row">
        <h1>Saisie carton</h1>
        <div class="muted small">Compté par : <b id="whoami"></b></div>
      </div>

      <div class="grid2">
        <div class="field">
          <label>Désignation</label>
          <input id="designation" placeholder="Tshirt / Polo / Chemise..." />
        </div>
        <div class="field">
          <label>Grammage</label>
          <input id="grammage" placeholder="Ex : 190" inputmode="numeric" />
        </div>

        <div class="field wide">
          <label>Référence (I = 1 auto)</label>
          <input id="ref" placeholder="Ex : E191" />
          <div class="hint">Règle : si tu écris “I”, l’app convertit en “1”.</div>
        </div>

        <div class="field">
          <label>Couleur</label>
          <input id="couleur" placeholder="Dark Grey / Urban Orange..." />
        </div>

        <div class="field">
          <label>Manches</label>
          <div class="seg">
            <button class="segbtn" data-m="MC" id="mMC">MC</button>
            <button class="segbtn" data-m="ML" id="mML">ML</button>
          </div>
          <div class="hint">Choisir MC ou ML.</div>
        </div>

        <div class="field">
          <label>Code carton (optionnel)</label>
          <input id="cartonCode" placeholder="Ex : A12-03" />
        </div>
      </div>

      <h2>Quantités par taille</h2>
      <p class="muted small">Laisse vide les tailles absentes. Entier uniquement.</p>

      <div class="sizes" id="sizesGrid"></div>

      <div class="row">
        <button class="btn" id="btnCalc">Calcul total</button>
        <div class="totalBox">Total carton : <b id="total">0</b></div>
      </div>

      <div class="actions">
        <button class="btn primary" id="btnSubmit">Valider & Envoyer</button>
        <button class="btn ghost" id="btnReset">Nouveau carton</button>
      </div>
    </section>
  </main>

  <div class="toast" id="toast" aria-live="polite"></div>

  <!-- IMPORTANT: module pour que Supabase ESM marche sur GitHub Pages -->
  <script type="module" src="./app.js"></script>
<div class="card">
  <h2>Scan étiquette (photo)</h2>

  <input id="photoInput" type="file" accept="image/*" capture="environment" />
  <button id="btnScanPhoto" type="button">Scanner la photo</button>

  <div id="scanStatus" class="muted"></div>
</div>
</body>
</html>