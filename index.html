<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Inventaire Atelier</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Supabase JS (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">⚡</div>
        <div>
          <div class="title">Inventaire Atelier</div>
          <div class="subtitle">Scan étiquette • Base centralisée • Totaux</div>
        </div>
      </div>

      <div class="session">
        <span id="whoami" class="whoami">Non connecté</span>
        <button id="btnLogout" class="btn btn-ghost" type="button" hidden>Déconnexion</button>
      </div>
    </header>

    <main class="grid">
      <!-- AUTH CARD -->
      <section class="card">
        <h2>Accès</h2>
        <p class="muted">
          5 personnes, méthode simple : <b>Nom + PIN (6 chiffres)</b>.
        </p>

        <div class="form">
          <label>Nom</label>
          <input id="name" type="text" placeholder="Ex: Mouna" autocomplete="off" />

          <label>PIN (6 chiffres)</label>
          <input id="pin" type="password" inputmode="numeric" maxlength="6" placeholder="******" />

          <label>Confirmer PIN (inscription uniquement)</label>
          <input id="pin2" type="password" inputmode="numeric" maxlength="6" placeholder="******" />

          <div class="actions">
            <button id="btnRegister" class="btn btn-primary" type="button">S’inscrire</button>
            <button id="btnLogin" class="btn btn-secondary" type="button">Se connecter</button>
          </div>

          <div id="authMsg" class="msg" aria-live="polite"></div>

          <details class="diag">
            <summary>Diagnostics rapides</summary>
            <pre id="diagOut"></pre>
          </details>
        </div>
      </section>

      <!-- INVENTORY CARD -->
      <section class="card">
        <h2>Saisie carton</h2>
        <p class="muted">Objectif : ultra-rapide, lisible, industriel. (Scan étiquette ensuite.)</p>

        <div class="form two">
          <div>
            <label>Désignation</label>
            <input id="designation" type="text" placeholder="Tshirt / Polo / Chemise..." />
          </div>

          <div>
            <label>Grammage</label>
            <input id="grammage" type="number" inputmode="numeric" placeholder="190" />
          </div>

          <div class="span2">
            <label>Référence</label>
            <input id="ref" type="text" placeholder="E191" />
          </div>

          <div class="span2">
            <label>Couleur</label>
            <input id="couleur" type="text" placeholder="Dark Grey / Urban Orange..." />
          </div>

          <div>
            <label>Manches</label>
            <div class="seg">
              <button id="mMC" type="button" class="seg-btn active">MC</button>
              <button id="mML" type="button" class="seg-btn">ML</button>
            </div>
          </div>

          <div>
            <label>Code carton (optionnel)</label>
            <input id="carton_code" type="text" placeholder="Ex: A12-03" />
          </div>
        </div>

        <h3>Quantités par taille</h3>
        <div class="sizes">
          <div class="size"><span>XS</span><input id="XS" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>S</span><input id="S" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>M</span><input id="M" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>L</span><input id="L" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>XL</span><input id="XL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>XXL</span><input id="XXL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>3XL</span><input id="3XL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>4XL</span><input id="4XL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>5XL</span><input id="5XL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>6XL</span><input id="6XL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>7XL</span><input id="7XL" type="number" inputmode="numeric" min="0" /></div>
          <div class="size"><span>8XL</span><input id="8XL" type="number" inputmode="numeric" min="0" /></div>
        </div>

        <div class="footerline">
          <div class="totalbox">
            Total carton: <b id="totalCarton">0</b>
          </div>
          <div class="actions">
            <button id="btnCalc" class="btn btn-ghost" type="button">Calcul total</button>
            <button id="btnSend" class="btn btn-primary" type="button">Valider & Envoyer</button>
          </div>
        </div>

        <div id="invMsg" class="msg" aria-live="polite"></div>
      </section>
    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>